#include <graphics.h>
#include <iostream>
#include <cmath>
#include <vector>

using namespace std;

// Function to draw a Bezier curve using recursive subdivision
void drawBezier(int x0, int y0, int x1, int y1, int x2, int y2, int x3, int y3, int depth) {
    if (depth == 0) {
        // Draw the line between points
        line(x0, y0, x3, y3);
    } else {
        // Calculate midpoints of the control points
        int mx01 = (x0 + x1) / 2, my01 = (y0 + y1) / 2;
        int mx12 = (x1 + x2) / 2, my12 = (y1 + y2) / 2;
        int mx23 = (x2 + x3) / 2, my23 = (y2 + y3) / 2;

        int mx012 = (mx01 + mx12) / 2, my012 = (my01 + my12) / 2;
        int mx123 = (mx12 + mx23) / 2, my123 = (my12 + my23) / 2;

        int mx0123 = (mx012 + mx123) / 2, my0123 = (my012 + my123) / 2;

        // Recursively draw the 4 sub-Bezier curves
        drawBezier(x0, y0, mx01, my01, mx012, my012, mx0123, my0123, depth - 1);
        drawBezier(mx0123, my0123, mx123, my123, mx23, my23, x3, y3, depth - 1);
    }
}

// Function to draw the Koch curve fractal
void drawKochCurve(int x1, int y1, int x2, int y2, int depth) {
    if (depth == 0) {
        // Draw the line segment
        line(x1, y1, x2, y2);
    } else {
        // Divide the line into 3 parts
        int dx = x2 - x1, dy = y2 - y1;
        int x3 = x1 + dx / 3, y3 = y1 + dy / 3;
        int x4 = x1 + 2 * dx / 3, y4 = y1 + 2 * dy / 3;

        // Calculate the peak of the equilateral triangle
        double angle = atan2(dy, dx) - M_PI / 3;
        int x5 = (x3 + x4) / 2 + 10 * cos(angle);
        int y5 = (y3 + y4) / 2 + 10 * sin(angle);

        // Recursively draw the 4 segments
        drawKochCurve(x1, y1, x3, y3, depth - 1);
        drawKochCurve(x3, y3, x5, y5, depth - 1);
        drawKochCurve(x5, y5, x4, y4, depth - 1);
        drawKochCurve(x4, y4, x2, y2, depth - 1);
    }
}

int main() {
    int gd = DETECT, gm;
    initgraph(&gd, &gm, NULL);

    // Draw Bezier Fractal
    setcolor(RED);
    drawBezier(100, 300, 200, 100, 300, 100, 400, 300, 4); // Adjust depth for more complexity

    // Draw Koch Curve Fractal
    setcolor(GREEN);
    drawKochCurve(50, 500, 450, 500, 4); // Adjust depth for more complexity

    getch();
    closegraph();
    return 0;
}